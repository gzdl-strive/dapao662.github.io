---
title: ECMAScript 11 新特性
date: 2021-11-16 10:28:02
toc: true
---

### String.prototype.matchAll

matchAll() 方法返回一个包含所有匹配正则表达式的结果及分组捕获组的迭代器

```js
let str = `<ul>
  <li>
      <a>肖生克的救赎</a>
      <p>上映日期: 1994-09-10</p>
  </li>
  <li>
      <a>阿甘正传</a>
      <p>上映日期: 1994-07-06</p>
  </li>
</ul>`;
//声明正则
const reg = /<li>.*?<a>(.*?)<\/a>.*?<p>(.*?)<\/p>/gs;
//调用方法
const result = str.matchAll(reg);
const arr = [...result];
console.log(arr);
```

### 类的私有属性

```js
class Person {
  //公有属性
  name;
  //私有属性
  #age;
  #weight;
  //构造方法
  constructor(name, age, weight) {
    this.name = name;
    this.#age = age;
    this.#weight = weight;
  }

  intro() {
    console.log(this.name);
    console.log(this.#age);
    console.log(this.#weight);
  }
}
//实例化
const girl = new Person("晓红", 18, "45kg");
console.log(girl.name);
console.log(girl.#age);
console.log(girl.#weight);
girl.intro();
```

### Promise.allSettled

该 Promise.allSettled()方法返回一个在所有给定的 promise 都已经 fulfilled 或 rejected 后的 promise，并带有一个对象数组，每个对象表示对应的 promise 结果。

当您有多个彼此不依赖的异步任务成功完成时，或者您总是想知道每个 promise 的结果时，通常使用它。

```js
//声明两个promise对象
const p1 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve("商品数据 - 1");
  }, 1000);
});

const p2 = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve("商品数据 - 2");
    // reject('出错啦!');
  }, 1000);
});

//调用 allsettled 方法
const result = Promise.allSettled([p1, p2]);

const res = Promise.all([p1, p2]);

console.log(res);
```

### 可选链操作符

```js
// ?.
function main(config) {
  // const dbHost = config && config.db && config.db.host;
  const dbHost = config?.db?.host;
  console.log(dbHost);
}

main({
  db: {
    host: "192.168.1.100",
    username: "root",
  },
  cache: {
    host: "192.168.1.200",
    username: "admin",
  },
});
```

### 动态 import 导入

```js
//app.js
// import * as m1 from "./hello.js";
//获取元素
const btn = document.getElementById("btn");
btn.onclick = function () {
  import("./hello.js").then((module) => {
    module.hello();
  });
};
```

### BigInt

```js
//大整型
let n = 521n;
console.log(n, typeof n);

//函数
let n = 123;
console.log(BigInt(n));
//不能使用浮点型值
// console.log(BigInt(1.2));

//大数值运算
let max = Number.MAX_SAFE_INTEGER;
console.log(max);
console.log(max + 1);
console.log(max + 2);

//大整型只能和大整型进行运算
console.log(BigInt(max));
console.log(BigInt(max) + BigInt(1));
console.log(BigInt(max) + BigInt(2));
```

### globalThis 对象

```js
console.log(globalThis);
```
