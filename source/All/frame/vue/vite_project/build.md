---
title: æ‰“åŒ…æ„å»º
date: 2022-03-23 14:30:24
toc: true
---

**é€šè¿‡ä¿®æ”¹package.jsonä¸­çš„æ‰“åŒ…å‘½ä»¤æ¥å®ç°åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ**

```json
{
  "script": {
    "build:dev": "vue-tsc --noEmit && vite build --mode dev",
    "build:pro": "vue-tsc --noEmit && vite build --mode pro"
  }
}
```

**åœ¨é¡¹ç›®ä¸­å°±å¯ä»¥é€šè¿‡`import.meta.env`è·å–åˆ°å¯¹åº”çš„ç¯å¢ƒ**

## é—®é¢˜1ã€æ‰“åŒ…åï¼Œæ”¾ç½®åœ¨assetsæ–‡ä»¶å¤¹ä¸­çš„å›¾ç‰‡å¼•ç”¨è·¯å¾„å‡ºé”™ï¼Œæœªèƒ½æ­£ç¡®æŒ‡å‘
```css
/* æºä»£ç  */
.xxxx {
  background: url('@/assets/bg.jpg');
}
```
æ‰“åŒ…åå‘ç°å¯¹åº”çš„cssä¸­è·¯å¾„æœªèƒ½æ­£ç¡®æŒ‡å‘
**å°è¯•1ï¼šå¯èƒ½æ˜¯è·¯å¾„åˆ«åé—®é¢˜-ã€‹ä½¿ç”¨ç»å¯¹è·¯å¾„->æœªè§£å†³**
**å°è¯•2ï¼šå°†å›¾ç‰‡æ”¾åˆ°publicæ–‡ä»¶å¤¹ï¼Œç›´æ¥æŒ‡å‘ï¼Œè¿˜æ˜¯ä¸èƒ½æ­£ç¡®æŒ‡å‘**
ä½†æ˜¯ä»ç¬¬äºŒæ¬¡å°è¯•ä¸­å‘ç°é—®é¢˜æ‰€åœ¨ï¼Œå› ä¸ºviteé»˜è®¤çš„èµ„æºç›®å½•å°±æ˜¯publicæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥åœ¨å°†å›¾ç‰‡æ”¾åˆ°publicä¸‹åç›´æ¥`/bg.jpg`å³å¯ï¼Œä½†æ˜¯æ‰“åŒ…åçš„è·¯å¾„å´å˜æˆäº†`./bg.jpg`. å¯ä»¥çŸ¥é“æ˜¯æˆ‘ä»¬viteé…ç½®çš„é—®é¢˜ï¼Œå½“æ—¶é…ç½®äº†base(å¼€å‘æˆ–ç”Ÿäº§ç¯å¢ƒæœåŠ¡çš„å…¬å…±åŸºç¡€è·¯å¾„),ä½†æ˜¯è®¾ç½®ä¸ºäº†`base: './'`æ‰€ä»¥å‡ºé”™äº†ï¼Œç„¶åå°†æ­¤é…ç½®åˆ é™¤ï¼Œå°†ä¹‹å‰çš„ä»£ç å’Œå›¾ç‰‡è·¯å¾„æ¢å¤æˆæœ€å¼€å§‹çš„æƒ…å†µï¼Œæ‰“åŒ…ok.

## é—®é¢˜äºŒã€æ‰“åŒ…åçš„ä¸èƒ½å…¼å®¹Chrome55ç‰ˆæœ¬
è§£å†³æ–¹æ³•ï¼šä¸‹è½½viteæ’ä»¶`yarn add @vitejs/plugin-legacy -D`;é€šè¿‡è¯¥æ’ä»¶æ¥è¿›è¡Œå…¼å®¹æ€§å¤„ç†
```ts
//vite.config.ts
import legacy from '@vitejs/plugin-legacy';

export default defineConfig({
  plugins: [
    //...
    legacy({
      targets: ['> 1%',' Chrome >= 55', 'ie >= 11'], //éœ€è¦å…¼å®¹çš„ç›®æ ‡åˆ—è¡¨ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ª
      additionalLegacyPolyfills: ['regenerator-runtime/runtime'], //é¢å‘IE11æ—¶éœ€è¦æ­¤æ’ä»¶
    })
  ]
})
```
ok

## é—®é¢˜ä¸‰ã€æ‰“åŒ…æ—¶å¦‚æœå­˜åœ¨ä¹‹å‰çš„distç›®å½•ï¼Œå°±ä¼šæŠ¥é”™(å¾…éªŒè¯ï¼Œåæ¥åˆæ­£å¸¸äº†ğŸ˜‚)
**ä¿®æ”¹viteé…ç½®çš„æ„å»ºé€‰é¡¹**
```ts
build: {
  emptyOutDir: false,
}
```

## é—®é¢˜å››ã€Element-Plusæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜
![1](/assets/vueImg/elementplus1.png "å…¼å®¹æ€§")
ä½†æ˜¯æˆ‘ä»¬éœ€è¦å…¼å®¹åˆ°è°·æ­Œ49ç‰ˆæœ¬

ä¸€å¼€å§‹æ²¡æœ‰å‘ç°è¯¥é—®é¢˜(ä½¿ç”¨el-inputã€el-asideç­‰ç»„ä»¶æ²¡æœ‰å‘ç°å¼‚å¸¸)ã€‚ç›´åˆ°ä½¿ç”¨äº†è¡¨æ ¼ã€ä¸‹æ‹‰æ¡†ã€çº§è”ç­‰ç»„ä»¶æ—¶å‘ç°æ§åˆ¶å°æŠ¥é”™`ResizeObserver is undefined`,é€šè¿‡æŸ¥çœ‹å®˜ç½‘æ‰å¾—çŸ¥ï¼Œ`ResizeObserver`æ˜¯æœ‰å…¼å®¹æ€§è¦æ±‚çš„[Resize Observer](https://caniuse.com/resizeobserver "Resize Observerå…¼å®¹æ€§"),å¯ä»¥å¾—çŸ¥Resize Observeråœ¨è°·æ­Œä¸­æœ€ä½éœ€è¦64ç‰ˆæœ¬ã€‚

æ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡polyfillæ¥å¸®åŠ©æˆ‘ä»¬æ”¯æŒæ›´ä½ç‰ˆæœ¬çš„è¦æ±‚ã€‚

**è§£å†³**
- å®‰è£…resize-observer-polyfill
```bash
npm install resize-observer-polyfill --save-dev
```

- åœ¨main.tsä¸­å¼•å…¥
```ts
import ResizeObserver from 'resize-observer-polyfill';
window.ResizeObserver = ResizeObserver;
```

ä¹‹å‰è¯•è¿‡ä¹‹é—´åœ¨main.tsä¸­`import 'resize-observer-polyfill';`ï¼Œå‘ç°è¿˜æ˜¯æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œè¿˜æ˜¯æŠ¥undefine,æ‰€ä»¥æˆ‘æ‰å°†å®ƒæŒ‚è½½åˆ°windowä¸‹ï¼Œè¿˜å¥½ï¼Œç”Ÿæ•ˆäº†ã€‚