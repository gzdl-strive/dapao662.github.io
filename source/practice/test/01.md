---
title: 可调侧栏
date: 2021-01-14 09:30:02
tag: practice
---

``` html
<div class="left">
    <div class="content">
        <img src="1.png" width="200" height="200" alt="图片">
    </div>
    <div class="separator">
        <i></i><i></i>
    </div>
</div>
<div class="right">
    <div class="content">
        hello World this is Ak47
    </div>
</div>
```

``` css

* {

    margin: 0;
    padding: 0;
}

body {
    min-height: 100vh;
    display: flex;
    /* 拖拽侧栏时不选中内容 */
    user-select: none;
    -webkit-user-select: none;
}

.left .content img {
    border-radius: 50%;
    /* 让img图片根据拖拽自动变化大小 */
    display: block;
    max-width: 100%;
    margin: auto;
}

.left {
    background-color: #cccccc;
    padding-right: 15px;
    position: relative;
    /* 设置最小宽度 */
    min-width: 100px;
}

.right {
    background-color: white;
    /* flex为1占据剩余的全部 */
    flex: 1;
}

.content {
    padding: 20px;
}

.left .separator {
    /* 使用绝对定位设置侧栏位置 */
    position: absolute;
    top: 0;
    right: 0;
    width: 15px;
    height: 100%;
    background-color: white;
    /* 使用box-shadow制作阴影 */
    /* 水平位置 垂直位置 模糊距离 阴影尺寸（影子大小） 阴影颜色 内/外阴影 */
    box-shadow: 0px 0px 2px rgba(0, 0, 0, .35);
    /* 设置居中使得下面的i标签居中 */
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: col-resize;
}

.left .separator i {
    display: inline-block;
    height: 20px;
    width: 1px;
    background-color: #e9e9e9;
    margin: 0 1px;
}
```

``` js
let startX, startWidth;
startWidth = localStorage.getItem('left_width') || getLeftWidth();

document.querySelector('left').style.width = startWidth + 'px';

// 获取侧栏的dom对象，设置鼠标按下事件源
document.querySelector('.separator').addEventListener('mousedown', startDrag);

function startDrag(e) {
    //e是指事件发生后，传回来的事件资料，clientX就是获取鼠标当前的x坐标
    startX = e.clientX;
    // 把获取左边容器宽度封装成一个函数，方便重用
    startWidth = getLeftWidth();
    //document.documentElement指的是html这一层的意思,将事件绑定到html上->无论鼠标移动到页面哪里都可以监听到
    document.documentElement.addEventListener('mousemove', onDrag);
    document.documentElement.addEventListener('mouseup', stopDrag);
}

function onDrag(e) {
    let newWidth = startWidth + e.clentX - startX;
    // newWidth现在是数字，需要加上单位才行
    document.querySelector('.left').style.width = newWidth + 'px';
}

function stopDrag(e) {
    // 使用localStorage缓存当鼠标松开时左边容器的宽度-->需要改变起始值
    localStorage.setItem('left_width', getLeftWidth());
    document.documentElement.removeEventListener('mousemove', onDrag);
    document.documentElement.removeEventListener('mouseup', stopDrag);
}

function getLeftWidth() {
    //获取左边div的宽度-->240px-->去掉px使用parseInt(xxx, 10);
    return parseInt(window.getComputedStyle(document.querySelector('.left')).width, 10);
}
```
